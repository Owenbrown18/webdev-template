---
import type { AboutContent } from '../../../types/content';
import { about, getAboutValuesVariant } from '../../../config/content';
import AboutValuesGrid from './AboutValuesGrid.astro';
import AboutValuesList from './AboutValuesList.astro';

const variants: Record<string, any> = {
  grid: AboutValuesGrid,
  list: AboutValuesList,
};

const variantKey = getAboutValuesVariant();
const Component = variantKey === 'none' ? null : variants[variantKey] ?? variants.grid;

const props = Astro.props as Partial<{
  title: string | null;
  intro: string | null;
  items: AboutContent['values'] extends { items?: infer T } ? T : undefined;
}>;

const base = about.values ?? {};
const title = props.title ?? base.title ?? 'Guided by service-first values';
const intro = props.intro ?? base.intro ?? `We show up with integrity, clear communication, and dependable follow-through on every project.`;
const rawItems = Array.isArray(props.items) ? props.items : base.items;
const items = Array.isArray(rawItems) ? rawItems.filter(Boolean) : [];
---
{Component && items.length > 0 ? (
  <Component title={title} intro={intro} items={items} />
) : null}
