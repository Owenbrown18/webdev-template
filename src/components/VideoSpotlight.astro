---
import { site } from '../config/content';

const media = site.media ?? {};
const {
  videoUrl = media.videoUrl ?? '',
  localVideo = media.localVideo ?? '',
  caption = media.caption ?? 'See our team in action.',
  posterUrl = media.posterUrl ?? '',
} = Astro.props;
const useLocalVideo = Boolean(localVideo);
const hasEmbed = Boolean(videoUrl);
const shouldRender = useLocalVideo || hasEmbed;
---
{shouldRender && (
  <section class="py-12 sm:py-16">
    <div class="mx-auto max-w-5xl px-6">
      <figure class="overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm">
        <div class="relative aspect-[18/7] w-full bg-slate-900">
          {useLocalVideo ? (
            <video
              src={localVideo}
              poster={posterUrl || undefined}
              autoplay
              muted
              loop
              playsinline
              class="absolute inset-0 h-full w-full object-cover"
            ></video>
          ) : (
            <iframe
              src={videoUrl}
              title={`Video from ${site.name}`}
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
              loading="lazy"
              class="absolute inset-0 h-full w-full"
            ></iframe>
          )}
        </div>
        {caption && (
          <figcaption class="px-6 py-4 text-sm text-slate-600">
            {caption}
          </figcaption>
        )}
      </figure>
    </div>
  </section>
)}
